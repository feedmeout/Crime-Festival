<!DOCTYPE html>
<html lang="el">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Έρευνα - Crime Festival 2025</title>
    
    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getFirestore, doc, setDoc } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';

        const firebaseConfig = {
            apiKey: "AIzaSyA_9_40aa_wO_19g-1bIrSB6742aMOPwjo",
            authDomain: "crime-festival-2025.firebaseapp.com",
            projectId: "crime-festival-2025",
            storageBucket: "crime-festival-2025.firebasestorage.app",
            messagingSenderId: "663770004335",
            appId: "1:663770004335:web:e42dbd983ab9b5277bc69a"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        
        window.firebaseDB = db;
        window.firebaseDoc = doc;
        window.firebaseSetDoc = setDoc;
        window.firebaseReady = true;
        
        console.log("✅ Firebase connected!");
    </script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 900px;
            margin: 0 auto;
        }
        
        .header {
            background: linear-gradient(135deg, #ff6b00 0%, #ff8800 100%);
            color: white;
            padding: 30px;
            border-radius: 15px;
            text-align: center;
            margin-bottom: 30px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
        }
        
        .header h1 {
            font-size: 28px;
            margin-bottom: 10px;
        }
        
        .progress-bar {
            background: rgba(255,255,255,0.2);
            height: 8px;
            border-radius: 4px;
            margin-top: 15px;
            overflow: hidden;
        }
        
        .progress-fill {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            height: 100%;
            transition: width 0.3s ease;
        }
        
        .section-content {
            background: white;
            border-radius: 15px;
            padding: 40px;
            margin-bottom: 20px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
        }
        
        .section-title {
            color: #1a1a2e;
            font-size: 24px;
            margin-bottom: 30px;
            padding-bottom: 15px;
            border-bottom: 3px solid #ff6b00;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .form-group {
            margin-bottom: 30px;
        }
        
        .form-group label {
            display: block;
            font-weight: 600;
            color: #333;
            margin-bottom: 12px;
            font-size: 15px;
            line-height: 1.5;
        }
        
        .required::after {
            content: " *";
            color: #dc3545;
            font-weight: bold;
        }
        
        .radio-group, .checkbox-group {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
            gap: 12px;
            margin-top: 12px;
        }
        
        .radio-option, .checkbox-option {
            display: flex;
            align-items: center;
            padding: 14px 16px;
            background: #f8f9fa;
            border: 2px solid #dee2e6;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .radio-option:hover, .checkbox-option:hover {
            border-color: #ff6b00;
            background: #fff5f0;
            transform: translateY(-1px);
        }
        
        .radio-option.selected, .checkbox-option.selected {
            border-color: #ff6b00;
            background: linear-gradient(135deg, rgba(255,107,0,0.1), rgba(255,136,0,0.1));
        }
        
        .radio-option input, .checkbox-option input {
            margin-right: 10px;
            cursor: pointer;
            width: 18px;
            height: 18px;
        }
        
        input[type="text"],
        input[type="number"],
        textarea {
            width: 100%;
            padding: 14px;
            border: 2px solid #dee2e6;
            border-radius: 10px;
            font-size: 15px;
            font-family: inherit;
            transition: all 0.2s ease;
        }
        
        textarea {
            min-height: 120px;
            resize: vertical;
        }
        
        input:focus, textarea:focus {
            outline: none;
            border-color: #ff6b00;
            box-shadow: 0 0 0 3px rgba(255,107,0,0.1);
        }
        
        .scale-info {
            background: linear-gradient(135deg, rgba(99,102,241,0.05), rgba(139,92,246,0.05));
            border: 2px solid #6366f1;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 30px;
        }
        
        .scale-legend {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 10px;
            margin-top: 12px;
        }
        
        .scale-legend span {
            text-align: center;
            padding: 10px;
            background: white;
            border-radius: 8px;
            font-size: 13px;
            font-weight: 500;
            border: 1px solid #dee2e6;
        }
        
        .scale-legend-7 {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
            gap: 8px;
            margin-top: 12px;
        }
        
        .scale-legend-7 span {
            text-align: center;
            padding: 8px 6px;
            background: white;
            border-radius: 8px;
            font-size: 12px;
            font-weight: 500;
            border: 1px solid #dee2e6;
        }
        
        .likert-group {
            background: #f8f9fa;
            padding: 24px;
            border-radius: 12px;
            margin-bottom: 20px;
            border: 1px solid #dee2e6;
            transition: all 0.2s ease;
        }
        
        .likert-group:hover {
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        
        .likert-question {
            display: block;
            font-weight: 600;
            color: #333;
            margin-bottom: 16px;
            line-height: 1.6;
        }
        
        .likert-scale, .likert-scale-7 {
            display: flex;
            justify-content: space-between;
            gap: 8px;
            padding: 0 5px;
        }
        
        .likert-option {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            cursor: pointer;
        }
        
        .likert-option input {
            display: none;
        }
        
        .likert-label {
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            background: white;
            border: 2px solid #dee2e6;
            font-weight: 700;
            font-size: 16px;
            transition: all 0.2s ease;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .likert-scale-7 .likert-label {
            width: 42px;
            height: 42px;
            font-size: 14px;
        }
        
        .likert-option:hover .likert-label {
            border-color: #ff6b00;
            transform: scale(1.1);
            box-shadow: 0 4px 8px rgba(255,107,0,0.3);
        }
        
        .likert-option input:checked + .likert-label {
            background: linear-gradient(135deg, #ff6b00 0%, #ff8800 100%);
            border-color: #ff6b00;
            color: white;
            transform: scale(1.15);
            box-shadow: 0 6px 12px rgba(255,107,0,0.4);
        }
        
        .subscale-header {
            font-size: 18px;
            font-weight: 700;
            background: linear-gradient(135deg, #ff6b00 0%, #ff8800 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin: 35px 0 20px 0;
            padding-bottom: 12px;
            border-bottom: 2px solid #dee2e6;
        }
        
        .navigation {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 25px;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
        }
        
        .btn {
            padding: 16px 32px;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.2s ease;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #ff6b00 0%, #ff8800 100%);
            color: white;
            box-shadow: 0 4px 12px rgba(255,107,0,0.3);
        }
        
        .btn-secondary {
            background: #6c757d;
            color: white;
        }
        
        .btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(0,0,0,0.3);
        }
        
        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }
        
        .error-message {
            background: #f8d7da;
            color: #721c24;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            border: 2px solid #f5c6cb;
            font-weight: 600;
            display: none;
        }
        
        .error-message.show {
            display: block;
            animation: shake 0.5s;
        }
        
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            75% { transform: translateX(10px); }
        }
        
        .info-box {
            background: #e7f3ff;
            border: 2px solid #2196f3;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }
        
        .info-box p {
            color: #0d47a1;
            line-height: 1.6;
            margin: 8px 0;
        }
        
        @media (max-width: 768px) {
            .section-content {
                padding: 25px 20px;
            }
            
            .radio-group, .checkbox-group {
                grid-template-columns: 1fr;
            }
            
            .navigation {
                flex-direction: column;
                gap: 12px;
                padding: 20px;
            }
            
            .btn {
                width: 100%;
            }
            
            .scale-legend, .scale-legend-7 {
                grid-template-columns: 1fr;
            }
            
            .likert-scale, .likert-scale-7 {
                gap: 4px;
            }
            
            .likert-label {
                width: 40px;
                height: 40px;
                font-size: 14px;
            }
            
            .likert-scale-7 .likert-label {
                width: 32px;
                height: 32px;
                font-size: 12px;
            }
        }
    </style>
</head>
<body>
    <div class="container" id="app">
        <div style="background: white; border-radius: 15px; padding: 40px; text-align: center;">
            <div style="font-size: 60px; margin-bottom: 20px;">⏳</div>
            <h2 style="color: #333;">Φόρτωση...</h2>
            <p style="color: #666; margin-top: 10px;">Παρακαλώ περιμένετε</p>
        </div>
    </div>

    <script>
        // Generate unique participant ID (combination of timestamp + random)
        const participantId = Date.now().toString(36) + Math.random().toString(36).substr(2, 9);
        
        let currentSection = 0; // Start at 0 for welcome screen
        let formData = {};
        let surveyType = null; // Will be set in welcome screen
        let branchPath = null;
        
        // Total sections depends on survey type (set after welcome screen)
        let totalSections = 0;

        setTimeout(() => {
            if (!window.firebaseReady) {
                showError('Σφάλμα σύνδεσης με Firebase. Ελέγξτε τη σύνδεση στο διαδίκτυο.');
                return;
            }
            
            renderCurrentSection();
        }, 1000);

        function renderCurrentSection() {
            let content = '';
            
            // Section 0: Welcome & Type Selection
            if (currentSection === 0) {
                content = renderWelcomeScreen();
            } else {
                // Show header with progress
                content += `
                    <div class="header">
                        <h1>${surveyType === 'pre' ? '📋 ΕΡΕΥΝΑ ΠΡΟ-ΠΑΡΕΜΒΑΣΗΣ' : '📊 ΕΡΕΥΝΑ ΜΕΤΑ-ΠΑΡΕΜΒΑΣΗΣ'}</h1>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: ${(currentSection / totalSections) * 100}%"></div>
                        </div>
                        <p style="margin-top: 12px; font-size: 14px;">Βήμα ${currentSection} από ${totalSections}</p>
                    </div>
                    
                    <div class="error-message" id="errorMessage"></div>
                `;
                
                if (surveyType === 'pre') {
                    if (currentSection === 1) content += renderIdentification();
                    if (currentSection === 2) content += renderDemographics();
                    if (currentSection === 3) content += renderGenAIExperience();
                    if (currentSection === 4) content += renderAIAttitudes();
                } else {
                    if (currentSection === 1) content += renderIdentification();
                    if (currentSection === 2) content += renderTAMScale();
                    if (currentSection === 3) content += renderOpenEnded();
                }
                
                // Navigation
                content += `
                    <div class="navigation">
                        <button class="btn btn-secondary" onclick="previousSection()" ${currentSection === 1 ? 'disabled' : ''}>
                            ← Προηγούμενο
                        </button>
                        <span style="color: #666; font-weight: 700;">Βήμα ${currentSection}/${totalSections}</span>
                        ${currentSection < totalSections ? 
                            `<button class="btn btn-primary" onclick="nextSection()">Επόμενο →</button>` :
                            `<button class="btn btn-primary" onclick="submitSurvey()" id="submitBtn">✅ Υποβολή</button>`
                        }
                    </div>
                `;
            }
            
            document.getElementById('app').innerHTML = content;
            attachEventListeners();
        }

        function renderWelcomeScreen() {
            return `
                <div class="section-content">
                    <div style="text-align: center; margin-bottom: 30px;">
                        <div style="font-size: 80px; margin-bottom: 20px;">🎯</div>
                        <h1 style="color: #1a1a2e; font-size: 32px; margin-bottom: 15px;">
                            Καλώς ήρθατε στην Έρευνα
                        </h1>
                        <p style="color: #666; font-size: 16px; line-height: 1.6;">
                            Crime Festival 2025 - Μελέτη Αξιολόγησης GenAI
                        </p>
                    </div>
                    
                    <div class="info-box">
                        <p><strong>📌 Σημαντικές Πληροφορίες:</strong></p>
                        <p>• Η έρευνα είναι ανώνυμη και εμπιστευτική</p>
                        <p>• Διάρκεια: 5-10 λεπτά</p>
                        <p>• Απαιτείται σύνδεση στο διαδίκτυο</p>
                        <p>• Οι απαντήσεις σας θα χρησιμοποιηθούν μόνο για ερευνητικούς σκοπούς</p>
                    </div>
                    
                    <div class="form-group" style="margin-top: 40px;">
                        <label class="required" style="font-size: 18px; text-align: center; display: block;">
                            Επιλέξτε τύπο έρευνας:
                        </label>
                        <div class="radio-group">
                            <label class="radio-option" style="padding: 25px;">
                                <input type="radio" name="survey-type" value="pre" required>
                                <div>
                                    <div style="font-size: 24px; margin-bottom: 8px;">📋</div>
                                    <strong style="display: block; margin-bottom: 5px;">ΠΡΟ-Παρέμβασης</strong>
                                    <small style="color: #666;">Συμπληρώστε ΠΡΙΝ τη δραστηριότητα</small>
                                </div>
                            </label>
                            <label class="radio-option" style="padding: 25px;">
                                <input type="radio" name="survey-type" value="post" required>
                                <div>
                                    <div style="font-size: 24px; margin-bottom: 8px;">📊</div>
                                    <strong style="display: block; margin-bottom: 5px;">ΜΕΤΑ-Παρέμβασης</strong>
                                    <small style="color: #666;">Συμπληρώστε ΜΕΤΑ τη δραστηριότητα</small>
                                </div>
                            </label>
                        </div>
                    </div>
                    
                    <div style="text-align: center; margin-top: 40px;">
                        <button class="btn btn-primary" onclick="startSurvey()" style="font-size: 18px; padding: 20px 50px;">
                            ΕΝΑΡΞΗ ΕΡΕΥΝΑΣ →
                        </button>
                    </div>
                </div>
            `;
        }

        function startSurvey() {
            const selected = document.querySelector('input[name="survey-type"]:checked');
            if (!selected) {
                alert('Παρακαλώ επιλέξτε τύπο έρευνας!');
                return;
            }
            
            surveyType = selected.value;
            totalSections = surveyType === 'pre' ? 4 : 3;
            currentSection = 1;
            renderCurrentSection();
            window.scrollTo(0, 0);
        }

        function renderIdentification() {
            return `
                <div class="section-content">
                    <h2 class="section-title">Αναγνωριστικά Στοιχεία</h2>
                    
                    <div class="info-box">
                        <p><strong>🔒 Εμπιστευτικότητα:</strong></p>
                        <p>Τα παρακάτω στοιχεία χρησιμοποιούνται μόνο για τη σύνδεση των απαντήσεων προ και μετά την παρέμβαση. Δεν θα κοινοποιηθούν σε τρίτους.</p>
                    </div>
                    
                    <div class="form-group">
                        <label for="team-name" class="required">Όνομα Ομάδας / Αριθμός Ομάδας</label>
                        <input type="text" id="team-name" name="team-name" 
                               placeholder="π.χ. Ομάδα 1, Alpha, κλπ." required>
                        <small style="color: #666; font-size: 13px;">Εισάγετε το όνομα ή τον αριθμό της ομάδας σας</small>
                    </div>
                    
                    <div class="form-group">
                        <label for="participant-code" class="required">Κωδικός Συμμετέχοντα (για σύνδεση προ-μετά)</label>
                        <input type="text" id="participant-code" name="participant-code" 
                               placeholder="π.χ. τα 4 πρώτα γράμματα του ονόματός σας + ημέρα γέννησης" required>
                        <small style="color: #666; font-size: 13px;">Παράδειγμα: Αν λέγεστε ΜΑΡΙΑ και γεννηθήκατε στις 15, γράψτε: ΜΑΡΙ15</small>
                    </div>
                    
                    <div style="background: #fff3cd; border: 2px solid #ffc107; padding: 15px; border-radius: 8px; margin-top: 20px;">
                        <strong style="color: #856404;">💡 Σημαντικό:</strong>
                        <p style="color: #856404; margin-top: 8px; font-size: 14px;">
                            Χρησιμοποιήστε τον ΙΔΙΟ κωδικό συμμετέχοντα και στις δύο έρευνες (προ και μετά) 
                            ώστε να μπορέσουμε να συνδέσουμε τις απαντήσεις σας.
                        </p>
                    </div>
                </div>
            `;
        }

        function renderDemographics() {
            return `
                <div class="section-content">
                    <h2 class="section-title">Δημογραφικά Στοιχεία</h2>
                    
                    <div class="form-group">
                        <label class="required">Φύλο</label>
                        <div class="radio-group">
                            <label class="radio-option">
                                <input type="radio" name="gender" value="male" required>
                                <span>Άνδρας</span>
                            </label>
                            <label class="radio-option">
                                <input type="radio" name="gender" value="female" required>
                                <span>Γυναίκα</span>
                            </label>
                            <label class="radio-option">
                                <input type="radio" name="gender" value="other" required>
                                <span>Άλλο</span>
                            </label>
                            <label class="radio-option">
                                <input type="radio" name="gender" value="prefer-not" required>
                                <span>Δεν επιθυμώ να απαντήσω</span>
                            </label>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="age" class="required">Ηλικία</label>
                        <input type="number" id="age" name="age" min="16" max="100" placeholder="Ηλικία σε έτη" required>
                    </div>
                    
                    <div class="form-group">
                        <label class="required">Επίπεδο εκπαίδευσης</label>
                        <div class="radio-group">
                            <label class="radio-option">
                                <input type="radio" name="education" value="highschool" required>
                                <span>Λύκειο</span>
                            </label>
                            <label class="radio-option">
                                <input type="radio" name="education" value="undergraduate" required>
                                <span>Προπτυχιακό</span>
                            </label>
                            <label class="radio-option">
                                <input type="radio" name="education" value="graduate" required>
                                <span>Μεταπτυχιακό</span>
                            </label>
                            <label class="radio-option">
                                <input type="radio" name="education" value="doctoral" required>
                                <span>Διδακτορικό</span>
                            </label>
                        </div>
                    </div>
                </div>
            `;
        }

        function renderGenAIExperience() {
            let branchContent = '';
            
            if (branchPath === 'yes') {
                branchContent = `
                    <div class="form-group">
                        <label class="required">Πόσο καιρό χρησιμοποιείτε εργαλεία ΓΤΝ;</label>
                        <div class="radio-group">
                            <label class="radio-option">
                                <input type="radio" name="genai-duration" value="less-1month" required>
                                <span>Λιγότερο από 1 μήνα</span>
                            </label>
                            <label class="radio-option">
                                <input type="radio" name="genai-duration" value="1-3months" required>
                                <span>1-3 μήνες</span>
                            </label>
                            <label class="radio-option">
                                <input type="radio" name="genai-duration" value="4-6months" required>
                                <span>4-6 μήνες</span>
                            </label>
                            <label class="radio-option">
                                <input type="radio" name="genai-duration" value="7-12months" required>
                                <span>7-12 μήνες</span>
                            </label>
                            <label class="radio-option">
                                <input type="radio" name="genai-duration" value="more-1year" required>
                                <span>Περισσότερο από 1 χρόνο</span>
                            </label>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="required">Τον τελευταίο μήνα, πόσο συχνά χρησιμοποιήσατε εργαλεία ΓΤΝ;</label>
                        <div class="radio-group">
                            <label class="radio-option">
                                <input type="radio" name="genai-frequency" value="daily" required>
                                <span>Καθημερινά</span>
                            </label>
                            <label class="radio-option">
                                <input type="radio" name="genai-frequency" value="4-6week" required>
                                <span>4-6 φορές την εβδομάδα</span>
                            </label>
                            <label class="radio-option">
                                <input type="radio" name="genai-frequency" value="2-3week" required>
                                <span>2-3 φορές την εβδομάδα</span>
                            </label>
                            <label class="radio-option">
                                <input type="radio" name="genai-frequency" value="once-week" required>
                                <span>Μία φορά την εβδομάδα</span>
                            </label>
                            <label class="radio-option">
                                <input type="radio" name="genai-frequency" value="2-3month" required>
                                <span>2-3 φορές τον μήνα</span>
                            </label>
                        </div>
                    </div>
                `;
            } else if (branchPath === 'no') {
                branchContent = `
                    <div class="form-group">
                        <label class="required">Ποιος είναι ο κύριος λόγος που δεν έχετε χρησιμοποιήσει εργαλεία ΓΤΝ;</label>
                        <div class="radio-group">
                            <label class="radio-option">
                                <input type="radio" name="non-use-reason" value="dont-know" required>
                                <span>Δεν γνωρίζω τι είναι ή πώς λειτουργούν</span>
                            </label>
                            <label class="radio-option">
                                <input type="radio" name="non-use-reason" value="no-access" required>
                                <span>Δεν έχω πρόσβαση σε αυτά</span>
                            </label>
                            <label class="radio-option">
                                <input type="radio" name="non-use-reason" value="dont-need" required>
                                <span>Δεν τα χρειάζομαι</span>
                            </label>
                            <label class="radio-option">
                                <input type="radio" name="non-use-reason" value="dont-trust" required>
                                <span>Δεν τα εμπιστεύομαι</span>
                            </label>
                            <label class="radio-option">
                                <input type="radio" name="non-use-reason" value="prefer-traditional" required>
                                <span>Προτιμώ παραδοσιακές μεθόδους</span>
                            </label>
                            <label class="radio-option">
                                <input type="radio" name="non-use-reason" value="privacy-concerns" required>
                                <span>Ανησυχίες για προσωπικά δεδομένα</span>
                            </label>
                        </div>
                    </div>
                `;
            }
            
            return `
                <div class="section-content">
                    <h2 class="section-title">Εμπειρία με Γενετική Τεχνητή Νοημοσύνη</h2>
                    
                    <div class="form-group">
                        <label class="required">Έχετε χρησιμοποιήσει ποτέ εργαλεία Generative AI (π.χ., ChatGPT, Claude, Gemini);</label>
                        <div class="radio-group">
                            <label class="radio-option">
                                <input type="radio" name="genai-used" value="yes" required>
                                <span>Ναι</span>
                            </label>
                            <label class="radio-option">
                                <input type="radio" name="genai-used" value="no" required>
                                <span>Όχι</span>
                            </label>
                            <label class="radio-option">
                                <input type="radio" name="genai-used" value="unsure" required>
                                <span>Δεν είμαι σίγουρος/η</span>
                            </label>
                        </div>
                    </div>
                    
                    ${branchContent}
                </div>
            `;
        }

        function renderAIAttitudes() {
            const questions = [
                'Είμαι εντυπωσιασμένος/η από αυτά που μπορεί να κάνει η Τεχνητή Νοημοσύνη',
                'Ενδιαφέρομαι να χρησιμοποιώ συστήματα τεχνητής νοημοσύνης στην καθημερινή μου ζωή',
                'Η Τεχνητή Νοημοσύνη είναι συναρπαστική',
                'Υπάρχουν πολλές ωφέλιμες εφαρμογές της Τεχνητής Νοημοσύνης',
                'Πιστεύω ότι τα συστήματα τεχνητής νοημοσύνης κάνουν πολλά λάθη',
                'Πιστεύω ότι η Τεχνητή Νοημοσύνη είναι επικίνδυνη',
                'Ανατριχιάζω από δυσφορία όταν σκέφτομαι τις μελλοντικές χρήσεις της Τεχνητής Νοημοσύνης'
            ];
            
            let content = `
                <div class="section-content">
                    <h2 class="section-title">Στάσεις Απέναντι στην ΤΝ</h2>
                    
                    <div class="scale-info">
                        <p><strong>Οδηγίες:</strong> Αξιολογήστε τις παρακάτω δηλώσεις σε μια κλίμακα από 1 έως 5:</p>
                        <div class="scale-legend">
                            <span><strong>1</strong> = Διαφωνώ Απόλυτα</span>
                            <span><strong>2</strong> = Διαφωνώ</span>
                            <span><strong>3</strong> = Ούτε Συμφωνώ Ούτε Διαφωνώ</span>
                            <span><strong>4</strong> = Συμφωνώ</span>
                            <span><strong>5</strong> = Συμφωνώ Απόλυτα</span>
                        </div>
                    </div>
            `;
            
            questions.forEach((question, idx) => {
                content += `
                    <div class="likert-group">
                        <label class="likert-question required">${question}</label>
                        <div class="likert-scale">
                            ${[1,2,3,4,5].map(val => `
                                <label class="likert-option">
                                    <input type="radio" name="ai-attitude-${idx+1}" value="${val}" required>
                                    <span class="likert-label">${val}</span>
                                </label>
                            `).join('')}
                        </div>
                    </div>
                `;
            });
            
            content += `</div>`;
            return content;
        }

        function renderTAMScale() {
            const puQuestions = [
                'Η χρήση του GenAI μου επέτρεψε να λύσω το μυστήριο πιο γρήγορα απ\' ό,τι θα μπορούσα χωρίς αυτό',
                'Η χρήση του GenAI βελτίωσε την απόδοση μου στην επίλυση του μυστηρίου',
                'Η χρήση του GenAI σε αυτή τη δραστηριότητα αύξησε την παραγωγικότητά μου',
                'Βρήκα το GenAI χρήσιμο για την επίλυση αυτού του μυστηρίου'
            ];
            
            const peuQuestions = [
                'Ήταν εύκολο για μένα να μάθω να χρησιμοποιώ το GenAI για αυτή τη δραστηριότητα',
                'Βρήκα εύκολο να κάνω το GenAI να με βοηθήσει σε αυτό που χρειαζόμουν',
                'Η αλληλεπίδρασή μου με το GenAI ήταν σαφής και κατανοητή',
                'Βρήκα το GenAI εύκολο στη χρήση για την επίλυση του μυστηρίου'
            ];
            
            let content = `
                <div class="section-content">
                    <h2 class="section-title">Αξιολόγηση Εμπειρίας Χρήσης ΓΤΝ</h2>
                    
                    <div class="scale-info">
                        <p><strong>Οδηγίες:</strong> Αξιολογήστε την εμπειρία σας με το GenAI (1-7):</p>
                        <div class="scale-legend-7">
                            <span><strong>1</strong> = Διαφωνώ Απόλυτα</span>
                            <span><strong>2</strong> = Διαφωνώ Πολύ</span>
                            <span><strong>3</strong> = Διαφωνώ</span>
                            <span><strong>4</strong> = Ουδέτερο</span>
                            <span><strong>5</strong> = Συμφωνώ</span>
                            <span><strong>6</strong> = Συμφωνώ Πολύ</span>
                            <span><strong>7</strong> = Συμφωνώ Απόλυτα</span>
                        </div>
                    </div>
                    
                    <h3 class="subscale-header">Αντιλαμβανόμενη Χρησιμότητα</h3>
            `;
            
            puQuestions.forEach((question, idx) => {
                content += `
                    <div class="likert-group">
                        <label class="likert-question required">${question}</label>
                        <div class="likert-scale-7">
                            ${[1,2,3,4,5,6,7].map(val => `
                                <label class="likert-option">
                                    <input type="radio" name="pu${idx+1}" value="${val}" required>
                                    <span class="likert-label">${val}</span>
                                </label>
                            `).join('')}
                        </div>
                    </div>
                `;
            });
            
            content += `<h3 class="subscale-header">Αντιλαμβανόμενη Ευκολία Χρήσης</h3>`;
            
            peuQuestions.forEach((question, idx) => {
                content += `
                    <div class="likert-group">
                        <label class="likert-question required">${question}</label>
                        <div class="likert-scale-7">
                            ${[1,2,3,4,5,6,7].map(val => `
                                <label class="likert-option">
                                    <input type="radio" name="peu${idx+1}" value="${val}" required>
                                    <span class="likert-label">${val}</span>
                                </label>
                            `).join('')}
                        </div>
                    </div>
                `;
            });
            
            content += `</div>`;
            return content;
        }

        function renderOpenEnded() {
            return `
                <div class="section-content">
                    <h2 class="section-title">Ερωτήσεις Ανοιχτού Τύπου</h2>
                    
                    <div class="form-group">
                        <label>Περιγράψτε τη στρατηγική που ακολουθήσατε για να λύσετε το μυστήριο με τη βοήθεια της ΓΤΝ:</label>
                        <textarea name="open-strategy" placeholder="Περιγράψτε αναλυτικά τη στρατηγική σας..."></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label>Ποιες δυσκολίες αντιμετωπίσατε στη χρήση της ΓΤΝ και πώς τις ξεπεράσατε;</label>
                        <textarea name="open-difficulties" placeholder="Περιγράψτε τις δυσκολίες που αντιμετωπίσατε και τις λύσεις που βρήκατε..."></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label>Τι μάθατε από αυτή την εμπειρία σχετικά με τη χρήση ΓΤΝ για επίλυση προβλημάτων;</label>
                        <textarea name="open-learning" placeholder="Περιγράψτε τι μάθατε από αυτή την εμπειρία..."></textarea>
                    </div>
                </div>
            `;
        }

        function attachEventListeners() {
            document.querySelectorAll('input[type="radio"]').forEach(radio => {
                radio.addEventListener('change', function() {
                    formData[this.name] = this.value;
                    document.querySelectorAll(`input[name="${this.name}"]`).forEach(r => {
                        const parent = r.closest('.radio-option, .likert-option');
                        if (parent) parent.classList.remove('selected');
                    });
                    const parent = this.closest('.radio-option, .likert-option');
                    if (parent) parent.classList.add('selected');
                    
                    if (this.name === 'genai-used') {
                        branchPath = this.value;
                        renderCurrentSection();
                    }
                });
                
                if (formData[radio.name] === radio.value) {
                    radio.checked = true;
                    const parent = radio.closest('.radio-option, .likert-option');
                    if (parent) parent.classList.add('selected');
                }
            });
            
            document.querySelectorAll('input[type="text"], input[type="number"], textarea').forEach(input => {
                input.addEventListener('change', function() {
                    formData[this.name || this.id] = this.value;
                });
                if (formData[input.name || input.id]) {
                    input.value = formData[input.name || input.id];
                }
            });
        }

        function nextSection() {
            if (!validateCurrentSection()) {
                showError('Παρακαλώ συμπληρώστε όλα τα υποχρεωτικά πεδία!');
                return;
            }
            
            hideError();
            if (currentSection < totalSections) {
                currentSection++;
                renderCurrentSection();
                window.scrollTo(0, 0);
            }
        }

        function previousSection() {
            hideError();
            if (currentSection > 1) {
                currentSection--;
                renderCurrentSection();
                window.scrollTo(0, 0);
            }
        }

        function validateCurrentSection() {
            const requiredRadios = {};
            document.querySelectorAll('input[type="radio"][required]').forEach(radio => {
                if (!requiredRadios[radio.name]) {
                    requiredRadios[radio.name] = false;
                }
                if (radio.checked) {
                    requiredRadios[radio.name] = true;
                }
            });
            
            for (let name in requiredRadios) {
                if (!requiredRadios[name]) {
                    return false;
                }
            }
            
            const requiredInputs = document.querySelectorAll('input[required]:not([type="radio"]), textarea[required]');
            for (let input of requiredInputs) {
                if (!input.value.trim()) {
                    return false;
                }
            }
            
            return true;
        }

        async function submitSurvey() {
            if (!validateCurrentSection()) {
                showError('Παρακαλώ συμπληρώστε όλα τα υποχρεωτικά πεδία!');
                return;
            }

            const submitBtn = document.getElementById('submitBtn');
            submitBtn.disabled = true;
            submitBtn.innerHTML = '⏳ Αποθήκευση...';

            try {
                const surveyData = {
                    participantId: participantId,
                    teamName: formData['team-name'],
                    participantCode: formData['participant-code'],
                    surveyType: surveyType,
                    submittedAt: new Date().toISOString(),
                    responses: formData,
                    branchPath: branchPath,
                    metadata: {
                        userAgent: navigator.userAgent,
                        language: navigator.language,
                        timestamp: Date.now()
                    }
                };

                const docRef = window.firebaseDoc(window.firebaseDB, 'surveys', participantId);
                await window.firebaseSetDoc(docRef, surveyData);

                showSuccessPage();
            } catch (error) {
                console.error('Error submitting survey:', error);
                showError('Σφάλμα αποθήκευσης! Παρακαλώ δοκιμάστε ξανά.');
                submitBtn.disabled = false;
                submitBtn.innerHTML = '✅ Υποβολή';
            }
        }

        function showSuccessPage() {
            document.getElementById('app').innerHTML = `
                <div style="background: white; border-radius: 15px; padding: 50px; text-align: center; box-shadow: 0 10px 40px rgba(0,0,0,0.3);">
                    <div style="font-size: 100px; margin-bottom: 30px; animation: successPop 0.6s ease-out;">✅</div>
                    <h1 style="color: #28a745; margin-bottom: 20px; font-size: 32px;">ΕΠΙΤΥΧΗΣ ΥΠΟΒΟΛΗ!</h1>
                    <p style="font-size: 20px; margin-bottom: 40px; color: #333;">
                        Η έρευνά σας καταγράφηκε με επιτυχία
                    </p>
                    <div style="background: linear-gradient(135deg, #e3f2fd, #bbdefb); padding: 25px; border-radius: 12px; margin-bottom: 30px; border: 2px solid #2196f3;">
                        <p style="margin: 10px 0;"><strong>Ομάδα:</strong> ${formData['team-name']}</p>
                        <p style="margin: 10px 0;"><strong>Τύπος Έρευνας:</strong> ${surveyType === 'pre' ? 'Προ-παρέμβασης' : 'Μετά-παρέμβασης'}</p>
                        <p style="margin: 10px 0; font-size: 14px; color: #666;"><strong>Κωδικός:</strong> ${formData['participant-code']}</p>
                    </div>
                    <p style="color: #666; font-size: 16px;">Ευχαριστούμε για τη συμμετοχή σας!<br>Μπορείτε να κλείσετε αυτή τη σελίδα</p>
                </div>
                
                <style>
                    @keyframes successPop {
                        0% { transform: scale(0); }
                        50% { transform: scale(1.2); }
                        100% { transform: scale(1); }
                    }
                </style>
            `;
        }

        function showError(message) {
            const errorDiv = document.getElementById('errorMessage');
            if (errorDiv) {
                errorDiv.textContent = message;
                errorDiv.classList.add('show');
                window.scrollTo({ top: 0, behavior: 'smooth' });
            }
        }

        function hideError() {
            const errorDiv = document.getElementById('errorMessage');
            if (errorDiv) {
                errorDiv.classList.remove('show');
            }
        }

        window.startSurvey = startSurvey;
        window.nextSection = nextSection;
        window.previousSection = previousSection;
        window.submitSurvey = submitSurvey;
    </script>
</body>
</html>