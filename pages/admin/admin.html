<!DOCTYPE html>
<html lang="el">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0">
    <meta name="description" content="Crime Festival 2025 - Admin Management Panel">
    <title>Admin Panel - TEK Management</title>

    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getFirestore, doc, setDoc, getDoc, getDocs, collection, deleteDoc, onSnapshot } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';
        const firebaseConfig = {
          apiKey: "AIzaSyA_9_40aa_wO_19g-1bIrSB6742aMOPwjo",
          authDomain: "crime-festival-2025.firebaseapp.com",
          projectId: "crime-festival-2025",
          storageBucket: "crime-festival-2025.firebasestorage.app",
          messagingSenderId: "663770004335",
          appId: "1:663770004335:web:e42dbd983ab9b5277bc69a"
        };
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        window.firebaseDB = db;
        window.firebaseDoc = doc;
        window.firebaseSetDoc = setDoc;
        window.firebaseGetDoc = getDoc;
        window.firebaseGetDocs = getDocs;
        window.firebaseCollection = collection;
        window.firebaseDeleteDoc = deleteDoc;
        window.firebaseOnSnapshot = onSnapshot;
        console.log("✅ Firebase connected!");
    </script>

    <link rel="stylesheet" href="../../css/admin/admin.css">
</head>

<body>
    <div class="container">
        <div class="header">
            <h1>🔒 CRIME MANAGEMENT</h1>
            <p>ADMIN PANEL</p>
        </div>
    
		<div class="section">
			<h2>➕ ΠΡΟΣΘΗΚΗ ΟΜΑΔΑΣ</h2>
			<div class="team-input">
				<input type="text" id="newTeamName" placeholder="ΟΝΟΜΑ" />
				<input type="text" id="newTeamPassword" placeholder="ΚΩΔΙΚΟΣ" />
				<input type="number" id="newTeamSize" placeholder="ΜΕΛΗ (1-10)" min="1" max="10" />
				<button class="btn btn-primary" onclick="addTeam()">ΠΡΟΣΘΗΚΗ ΟΜΑΔΑΣ</button>
			</div>

			<div style="margin-top: 15px; padding: 12px; background: #e3f2fd; border-radius: 8px; border-left: 4px solid #2196f3;">
				<label style="display: flex; align-items: center; gap: 10px; cursor: pointer; font-size: 14px;">
					<input type="checkbox" id="testingModeCheckbox" style="width: 20px; height: 20px; cursor: pointer;">
					<span style="font-weight: bold; color: #0d47a1;">🧪 ΛΕΙΤΟΥΡΓΙΑ ΔΟΚΙΜΩΝ</span>
				</label>
			</div>
			
			<div id="addTeamAlert"></div>
		</div>

<div class="section">
    <h2>📊 ΔΙΑΧΕΙΡΗΣΗ</h2>
    <div style="background: linear-gradient(135deg, #ffc107 0%, #ff9800 100%); padding: 15px; border-radius: 8px; margin-bottom: 20px; text-align: center;">
        <label style="color: #000; font-weight: 700; margin-right: 10px;">ΛΕΙΤΟΥΡΓΙΑ:</label>
        <select id="adminMode" onchange="toggleAdminMode()" style="padding: 8px 15px; border-radius: 5px; border: 2px solid #000; font-weight: 700;">
            <option value="live">🎮 LIVE EVENT</option>
            <option value="testing">🧪 TESTING MODE</option>
        </select>
    </div>

    <h3 style="color: #0f3460; margin-top: 0;">🎪 EVENT OPERATIONS</h3>
    
    <!-- Row 1: Main Operations -->
    <div class="quick-actions">
        <button class="btn" style="background: #ffc107; color: #000;" onclick="window.location.href='leaderboard.html'">🏆 LEADERBOARD (ADMIN)</button>
        <button class="btn" id="leaderboardToggleBtn" style="background: #dc3545; color: white;" onclick="toggleLeaderboard()">🔒 LEADERBOARD (TEAMS)</button>
        <button class="btn" style="background: #9c27b0; color: white;" onclick="openAlertModal()">📢 ΑΠΟΣΤΟΛΗ ΕΙΔΟΠΟΙΗΣΗΣ</button>
    </div>

    <!-- Row 2: Game Master Observations -->
    <div class="quick-actions" style="margin-top: 10px;">
        <button class="btn" style="background: #059669; color: white;" onclick="window.location.href='observation.html'">➕ NEW OBSERVATION</button>
        <button class="btn" style="background: #2563eb; color: white;" onclick="window.location.href='observations-dashboard.html'">👀 VIEW OBSERVATIONS</button>
        <button class="btn" style="background: #7c3aed; color: white;" onclick="window.location.href='observations-analytics.html'">📊 OBSERVATION ANALYTICS</button>
    </div>

    <!-- Rest of your sections remain the same -->
    <h3 style="color: #0f3460;">💾 DATA MANAGEMENT</h3>
    <div class="quick-actions">
        <button class="btn" style="background: #17a2b8; color: white;" onclick="exportAllData()">💾 EXPORT DATA (GAME)</button>
        <button class="btn" style="background: #6c757d; color: white;" onclick="importData()">📥 IMPORT DATA (GAME)</button>
        <button class="btn" style="background: #059669; color: white;" onclick="exportSurveyDataToExcel()">📊 EXPORT SURVEYS (EXCEL)</button>
    </div>

	<h3 style="color: #0f3460;">🧪 TESTING TOOLS</h3>
	<div class="quick-actions">
		<button class="btn btn-secondary" onclick="unlockAllForAll()">🔓 ΞΕΚΛΕΙΔΩΜΑ ΤΕΚΜΗΡΙΩΝ (ΟΛΩΝ)</button>
		<button class="btn" style="background: #17a2b8; color: white;" onclick="resetAllProgress()">🔄 RESET PROGRESS (ΟΛΕΣ)</button>
		<button class="btn" style="background: #9c27b0; color: white;" onclick="setupTestEnvironment()">🎲 DEMO ENVIRONMENT</button>
	</div>

    <h3 style="color: #dc3545;">⚠️ DANGER ZONE</h3>
    <div class="quick-actions" style="border: 2px solid #dc3545; padding: 15px; border-radius: 8px; background: rgba(220, 53, 69, 0.05);">
        <button class="btn" style="background: #e91e63; color: white;" onclick="deleteAllAlerts()">🗑️ ΔΙΑΓΡΑΦΗ ΕΙΔΟΠΟΙΗΣΕΩΝ (ΟΛΩΝ)</button>
        <button class="btn" style="background: #b91c1c; color: white;" onclick="deleteALLSurveysNuclear()">🗑️ ΔΙΑΓΡΑΦΗ ΕΡΩΤΗΜΑΤΟΛΟΓΙΩΝ (ΟΛΑ)</button>
        <button class="btn btn-danger" onclick="resetAll()">🗑️ ΔΙΑΓΡΑΦΗ ΟΜΑΔΩΝ (ΟΛΕΣ)</button>
    </div>
</div>

        <div class="section">
            <h2>👥 ΟΜΑΔΕΣ</h2>
            
            <div class="sort-controls">
                <label>ΤΑΞΙΝΟΜΗΣΗ:</label>
                <select id="sortOrder" onchange="refreshTeams()">
                    <option value="name">ΟΝΟΜΑ</option>
                    <option value="progress">ΠΡΟΟΔΟΣ</option>
                    <option value="completion">ΧΡΟΝΟΣ ΟΛΟΚΛΗΡΩΣΗΣ (ΤΑΧΥΤΕΡΟ)</option>
                    <option value="recent">ΠΙΟ ΠΡΟΣΦΑΤΟ</option>
                </select>
            </div>
            
            <div id="teamsContainer" class="team-list"></div>
        </div>
    </div>

    <div id="timestampModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modalTeamName">ΧΡΟΝΙΚΑ ΣΗΜΕΙΑ</h2>
                <span class="close-modal" onclick="closeModal()">&times;</span>
            </div>
            <div id="modalContent"></div>
        </div>
    </div>

    <div id="alertModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>📢 ΑΠΟΣΤΟΛΗ ΕΙΔΟΠΟΙΗΣΗΣ</h2>
                <span class="close-modal" onclick="closeAlertModal()">&times;</span>
            </div>
            <div style="padding: 20px 0;">
                <div class="form-group">
                    <label>ΕΠΙΛΟΓΗ ΠΑΡΑΛΗΠΤΗ:</label>
                    <select id="alertTarget">
                        <option value="all">📢 ΟΛΕΣ ΟΙ ΟΜΑΔΕΣ</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>ΜΗΝΥΜΑ:</label>
                    <textarea 
                        id="alertMessage" 
                    ></textarea>
                </div>
                
                <div style="display: flex; gap: 10px; justify-content: flex-end;">
                    <button class="btn btn-secondary" onclick="closeAlertModal()">❌ ΑΚΥΡΩΣΗ</button>
                    <button class="btn" style="background: #9c27b0; color: white;" onclick="sendAlert()">📢 ΑΠΟΣΤΟΛΗ</button>
                </div>
            </div>
        </div>
    </div>

    <div id="firebaseStatus">
        ✅ Firebase Connected - Data Synced to Cloud
    </div>

    <script src="../../js/admin/admin.js"></script>
</body>
</html>