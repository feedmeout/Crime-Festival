<!DOCTYPE html>
<html lang="el">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0">
    <meta name="theme-color" content="#1a1a2e">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>Φάκελος Υπόθεσης - Φεστιβάλ Αστυνομικής Λογοτεχνίας 2025</title>

    <!-- Preload critical CSS files -->
    <link rel="preload" href="css/variables.css" as="style">
    <link rel="preload" href="css/common.css" as="style">

    <!-- Load CSS files -->
    <link rel="stylesheet" href="css/variables.css">
    <link rel="stylesheet" href="css/common.css">

    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getFirestore, doc, setDoc, getDoc, onSnapshot, collection, getDocs } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';

        const firebaseConfig = {
            apiKey: "AIzaSyA_9_40aa_wO_19g-1bIrSB6742aMOPwjo",
            authDomain: "crime-festival-2025.firebaseapp.com",
            projectId: "crime-festival-2025",
            storageBucket: "crime-festival-2025.firebasestorage.app",
            messagingSenderId: "663770004335",
            appId: "1:663770004335:web:e42dbd983ab9b5277bc69a"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        window.firebaseDB = db;
        window.firebaseDoc = doc;
        window.firebaseSetDoc = setDoc;
        window.firebaseGetDoc = getDoc;
        window.firebaseOnSnapshot = onSnapshot;
        window.firebaseCollection = collection;
        window.firebaseGetDocs = getDocs;
        
        console.log("✅ Firebase connected in index.html!");
    </script>
</head>

<body>
    <div class="animated-background"></div>

    <div class="header">
        <h1>⚠️ ΦΑΚΕΛΟΣ ΥΠΟΘΕΣΗΣ ⚠️</h1>
        <div class="team-info" id="teamInfo" style="display: none;">
            <strong id="teamName"></strong>
        </div>
    </div>

    <div class="container">
        <div class="timer-section" id="timerSection">
            <h2>⏱️ ΧΡΟΝΟΜΕΤΡΗΣΗ ΟΜΑΔΑΣ</h2>
            <div class="timer-grid">
                <div class="timer-box">
                    <strong>Έναρξη</strong>
                    <div class="value" id="startTime">--:--</div>
                </div>
                <div class="timer-box">
                    <strong id="liveTimerLabel">Χρόνος</strong>
                    <div class="value" id="liveTimer">0λ 0δ</div>
                </div>
            </div>
        </div>

        <div class="tabs-container">
            <div class="tabs-nav">
                <button class="tab-button active" data-tab="intro">📋 ΠΕΡΙΣΤΑΤΙΚΟ</button>
                <button class="tab-button" data-tab="forensics">🥼 ΙΑΤΡΟΔΙΚΑΣΤΙΚΗ & ΧΡΟΝΟΛΟΓΙΟ</button>
                <button class="tab-button" data-tab="suspects">👥 ΚΑΤΑΛΟΓΟΣ ΥΠΟΠΤΩΝ</button>
                <button class="tab-button" data-tab="evidence">📦 ΤΕΚΜΗΡΙΑ</button>
                <button class="tab-button" data-tab="solution">✅ ΛΥΣΗ</button>
                <button class="tab-button" data-tab="survey">📊 ΕΡΕΥΝΑ</button>
                <button class="tab-button" data-tab="results">🏆 ΚΑΤΑΤΑΞΗ</button>
            </div>

            <div class="tabs-content">
                <div class="tab-pane active" id="tab-intro">
                    <div class="intro-box">
                        <h2>📋 ΠΕΡΙΣΤΑΤΙΚΟ</h2>
                        <p><strong>ΘΥΜΑ:</strong> ΔΗΜΗΤΡΙΟΥ ΠΕΤΡΟΣ του ΙΩΑΝΝΗ, ΑΦΜ: 074XXXXXX</p>
                        <p><strong>ΗΛΙΚΙΑ:</strong> 55 ετών | <strong>ΟΙΚ. ΚΑΤΑΣΤΑΣΗ:</strong> Παντρεμένος, 2 τέκνα</p>
                        <p><strong>ΕΠΑΓΓΕΛΜΑ:</strong> Εκδότης, Ιδρυτής/CEO «ΛΟΓΟΣ ΕΚΔΟΣΕΙΣ Α.Ε.»</p>
                        <p><strong>ΤΟΠΟΣ ΕΥΡΕΣΗΣ:</strong> Ιδιωτικό γραφείο, Σταδίου 47, 7ος όροφος</p>
                        <p><strong>ΗΜΕΡΑ ΕΥΡΕΣΗΣ:</strong> Τρίτη 23/09, 07:15 π.μ. | <strong>ΚΛΗΣΗ ΑΣΤΥΝΟΜΙΑΣ:</strong> 07:18</p>
                        <p style="font-style: italic; color: #00008b; margin-top: 15px;">Σημείωση: Ασφάλεια ζωής €1εκ. - ακυρώνεται σε περίπτωση αυτοκτονίας</p>
                    </div>

                    <div class="story-box">
                        <h2>📖 Η ΥΠΟΘΕΣΗ</h2>
                        <p>Ο Πέτρος Δημητρίου ήταν γνωστός εκδοτικός μεγιστάνας με επιτυχημένη καριέρα τριών δεκαετιών. Πριν από τρεις εβδομάδες έλαβε μια διάγνωση που άλλαξε τα πάντα: καρκίνος παγκρέατος τελικού σταδίου, με προσδόκιμο ζωής 2-3 μήνες. Η είδηση ήταν γνωστή μόνο στον ιατρό του και τη γραμματέα του.</p>
                        <p>Το πρωί της Τρίτης 23 Σεπτεμβρίου, η προσωπική γραμματέας Μαρία Παπαδοπούλου φτάνει στο γραφείο νωρίτερα από το συνηθισμένο (07:15 αντί για 08:30) και ανακαλύπτει το άψυχο σώμα του Δημητρίου στις τουαλέτες του 7ου ορόφου. Στον υπολογιστή του γραφείου βρέθηκε ένα email «αυτοκτονίας» αποσταλμένο στις 21:25 το προηγούμενο βράδυ. Οι πρώτες ενδείξεις έδειχναν αυτοκτονία από δηλητηρίαση με κυάνιο.</p>
                        <p>Ωστόσο, η εξέταση της σκηνής και η ανάκριση του προσωπικού αποκάλυψαν ανωμαλίες που προκαλούν υποψίες...</p>
                    </div>
                </div>

                <div class="tab-pane" id="tab-forensics">
					<div class="forensic-box">
						<h2>🥼 ΙΑΤΡΟΔΙΚΑΣΤΙΚΗ ΕΚΘΕΣΗ</h2>
						<p><strong>ΤΟΠΟΣ ΕΥΡΕΣΗΣ:</strong> Τουαλέτες, 7ος όροφος</p>
						<p><strong>ΩΡΑ ΘΑΝΑΤΟΥ:</strong> 21:30 - 21:50 (εκτιμώμενο εύρος)</p>
						<p><strong>ΑΙΤΙΑ:</strong> Οξεία δηλητηρίαση από κυανιούχο κάλιο (75mg εντερικά)</p>
						<p><strong>ΤΟΞΙΚΟΛΟΓΙΚΗ:</strong> Αλκοόλ 0.12% (2-3 ποτά), Αλπραζολάμη 2mg (θεραπευτική δόση)</p>
						<p><strong>ΣΗΜΕΙΩΣΗ:</strong> Η αλπραζολάμη επιταχύνει την απορρόφηση κυανίου και ενισχύει τη δηλητηριώδη δράση κατά 40-60%</p>
						<p><strong>ΕΚΤΙΜΗΣΗ:</strong> Ο θάνατος επήλθε 5-15 λεπτά μετά την κατάποση</p>
						<p><strong>ΤΡΑΥΜΑΤΑ:</strong> Κανένα αμυντικό τραύμα</p>
						<p><strong>ΠΑΘΟΛΟΓΙΚΗ:</strong> <span class="red-highlight">Καρκίνος παγκρέατος τελικού σταδίου - προσδόκιμο ζωής 2-3 μήνες</span></p>
					</div>

					<div class="timeline-box">
						<h2>🕐 ΧΡΟΝΟΛΟΓΙΟ ΣΥΜΒΑΝΤΩΝ</h2>
						<div class="timeline-item"><strong>17:30-18:30</strong> - Οι περισσότεροι υπάλληλοι αποχωρούν από το κτίριο</div>
						<div class="timeline-item"><strong>18:30</strong> - Νικολάου φεύγει από το κτίριο (κάμερες εξόδου)</div>
						<div class="timeline-item"><strong>19:00</strong> - Παράδοση φαγητού στο γραφείο του Δημητρίου</div>
						<div class="timeline-item"><strong>20:00</strong> - Πετρόπουλος αναλαμβάνει βάρδια</div>
						<div class="timeline-item"><strong>20:22</strong> - Ψηφιακό log: Έλεγχος 7ου ορόφου από Πετρόπουλο</div>
						<div class="timeline-item"><strong>20:37</strong> - Αναγνώστου στάση σε περίπτερο για τσιγάρα (πληρωμή με κάρτα)</div>
						<div class="timeline-item"><strong>20:40</strong> - Μαυρίδη εισέρχεται στο κτίριο να αφήσει αντίτυπα (κάρτα εισόδου)</div>
						<div class="timeline-item"><strong>20:45</strong> - SMS στο κινητό Δημητρίου: «Θα τελειώσει απόψε»</div>
						<div class="timeline-item"><strong>20:48</strong> - Νυχτερινή καθαρίστρια (Ελένη Κ.) είδε Πετρόπουλο στον 3ο όροφο</div>
						<div class="timeline-item"><strong>20:49</strong> - Αναγνώστου εισέρχεται στο κτίριο (κάρτα εισόδου)</div>
						<div class="timeline-item"><strong>20:53</strong> - Μη εξουσιοδοτημένη πρόσβαση στο σύστημα κάμερων (τεχνικό log)</div>
						<div class="timeline-item"><strong>20:55</strong> - Κάμερες απενεργοποιούνται</div>
						<div class="timeline-item"><strong>21:25</strong> - Email «αυτοκτονίας» αποστέλλεται</div>
						<div class="timeline-item"><strong>21:27</strong> - Μαυρίδη φεύγει (κάρτα parking)</div>
						<div class="timeline-item"><strong>21:30-21:50</strong> - <span class="timeline-critical">ΘΑΝΑΤΟΣ ΔΗΜΗΤΡΙΟΥ</span></div>
						<div class="timeline-item"><strong>21:42</strong> - Επαναλειτουργία κάμερων (αυτόματη επαναφορά)</div>
						<div class="timeline-item"><strong>21:55</strong> - Αναγνώστου φεύγει (κάρτα εξόδου)</div>
						<div class="timeline-item"><strong>07:15 (23/09)</strong> - Ανακάλυψη πτώματος από Παπαδοπούλου</div>
					</div>
                </div>

                <div class="tab-pane" id="tab-suspects">
                    <div id="suspectsContainer"></div>
                </div>

                <div class="tab-pane" id="tab-evidence">
                    <div class="progress-bar-container">
                        <div class="progress-title">📊 ΠΡΟΟΔΟΣ ΕΡΕΥΝΑΣ</div>
                        <div class="progress-bar">
                            <div class="progress-fill" id="progressFill">0%</div>
                        </div>
<div class="progress-text" id="progressText">
    <span style="font-weight: bold; color: #ff6b00;">ΕΧΕΤΕ ΞΕΚΛΕΙΔΩΣΕΙ</span>
    <span id="unlockedCount" style="font-size: 1.3em; font-weight: bold; color: #28a745; margin: 0 8px;">0</span>
    <span style="font-weight: bold; color: #ff6b00;">ΑΠΟ</span>
    <span id="totalCount" style="font-size: 1.3em; font-weight: bold; color: #1a1a2e; margin: 0 8px;">11</span>
    <span style="font-weight: bold; color: #ff6b00;">ΤΕΚΜΗΡΙΑ</span>
    <span id="progressEmoji" style="font-size: 1.5em; margin-left: 10px;">🔒</span>
</div>
                    </div>

                    <h2 class="section-title">📦 ΤΕΚΜΗΡΙΑ</h2>
                    <div class="evidence-grid" id="evidenceGrid"></div>
                </div>

                <div class="tab-pane" id="tab-solution">
                    <div class="intro-box" id="solutionIntroBox">
                        <h2>✅ ΥΠΟΒΟΛΗ ΛΥΣΗΣ</h2>
                        <p>Έχετε μελετήσει όλα τα τεκμήρια και είστε έτοιμοι να υποβάλετε τη λύση σας;</p>
                    </div>

                    <div class="solution-form" id="solutionForm">
                        <h3 style="color: #1a1a2e; margin-bottom: 20px;">ΕΠΙΛΟΓΗ</h3>
                        
                        <div class="suspect-options">
                            <div class="suspect-option">
                                <input type="checkbox" id="suspect_maria" name="suspect" value="maria">
                                <label for="suspect_maria">👩🏻‍🎨 Παπαδοπούλου Μαρία</label>
                            </div>
                            
                            <div class="suspect-option">
                                <input type="checkbox" id="suspect_konstantinos" name="suspect" value="konstantinos">
                                <label for="suspect_konstantinos">👨🏻‍💼 Αναγνώστου Κωνσταντίνος</label>
                            </div>
                            
                            <div class="suspect-option">
                                <input type="checkbox" id="suspect_eleni" name="suspect" value="eleni">
                                <label for="suspect_eleni">👩🏻‍🎨 Μαυρίδη Ελένη</label>
                            </div>
                            
                            <div class="suspect-option">
                                <input type="checkbox" id="suspect_georgios" name="suspect" value="georgios">
                                <label for="suspect_georgios">👮 Πετρόπουλος Γεώργιος</label>
                            </div>
                            
                            <div class="suspect-option">
                                <input type="checkbox" id="suspect_alexandra" name="suspect" value="alexandra">
                                <label for="suspect_alexandra">👩‍💻 Νικολάου Αλεξάνδρα</label>
                            </div>
                            
                            <div class="suspect-option">
                                <input type="checkbox" id="suspect_suicide" name="suspect" value="suicide">
                                <label for="suspect_suicide">💀 Αυτοκτονία</label>
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="justification">ΑΙΤΙΟΛΟΓΗΣΗ ΛΥΣΗΣ: *</label>
                            <textarea 
                                id="justification" 
                                placeholder="Προσθέστε την ανάλυση / αιτιολόγησή σας..."
                                required
                            ></textarea>
                        </div>

                        <div class="form-group">
                            <label for="promptCount">ΑΡΙΘΜΟΣ PROMPTS ΠΟΥ ΧΡΗΣΙΜΟΠΟΙΗΣΑΤΕ: *</label>
                            <input 
                                type="number" 
                                id="promptCount" 
                                min="0" 
                                step="1" 
                                placeholder="π.χ. 5"
                                required
                            >
							<p style="font-size: 12px; color: #666; margin-top: 5px; font-style: italic;">
								Να γίνει υπό την επίβλεψη ενός Game Master
							</p>
													</div>

                        <button type="button" class="submit-btn" onclick="submitSolution()">
                            ✅ ΥΠΟΒΟΛΗ ΛΥΣΗΣ
                        </button>
                    </div>

                    <div id="solutionResult" style="display: none;"></div>
                </div>

                <div class="tab-pane" id="tab-survey">
                    <div class="intro-box survey-tab-content">
                        <div class="survey-icon">📊</div>
                        <h2 class="survey-title">ΕΡΕΥΝΑ ΑΞΙΟΛΟΓΗΣΗΣ ΑΠΟΨΕΩΝ & ΕΜΠΕΙΡΙΩΝ</h2>                     
                        <a href="#" 
                           onclick="openSurvey(); return false;" 
                           class="btn btn-primary" 
                           style="margin-top: 20px; font-size: clamp(16px, 3.5vw, 18px); padding: clamp(15px, 3vw, 18px) clamp(30px, 6vw, 40px);">
                            📊 ΜΕΤΑΒΑΣΗ ΣΤΟ ΕΡΩΤΗΜΑΤΟΛΟΓΙΟ
                        </a>
                    </div>
                </div>

                <div class="tab-pane" id="tab-results">
                    <div id="surveysIncomplete" style="display: none; padding-bottom: 80px;">
                        <div class="intro-box" style="text-align: center; padding: 60px 30px;">
                            <div style="font-size: clamp(80px, 20vw, 120px); margin-bottom: 30px;">🔒</div>
                            <h2 style="color: #1a1a2e; font-size: clamp(20px, 5vw, 28px); margin-bottom: 20px;">
                                Ολοκληρώστε Πρώτα τις Έρευνες
                            </h2>
                            <div style="background: #fff3cd; border: 2px solid #ffc107; border-radius: 12px; padding: 20px; margin: 20px auto; max-width: 500px;">
                                <div style="font-size: 24px; margin-bottom: 10px;">📋</div>
                                <div style="color: #856404; font-weight: bold; margin-bottom: 10px;">ΚΑΤΑΣΤΑΣΗ ΕΡΕΥΝΩΝ:</div>
                                <div id="surveyStatus" style="color: #666; font-size: 14px; line-height: 1.8;">
                                    <div id="preSurveyStatus">⏳ Έλεγχος...</div>
                                    <div id="postSurveyStatus">⏳ Έλεγχος...</div>
                                </div>
                            </div>
                            <a href="#" 
                               onclick="window.location.href='pages/survey.html?team=' + encodeURIComponent(sessionStorage.getItem('teamCode')) + '&member=' + encodeURIComponent(sessionStorage.getItem('memberName')); return false;"
                               class="btn btn-primary" 
                               style="margin-top: 20px; font-size: clamp(16px, 3.5vw, 18px); padding: clamp(15px, 3vw, 18px) clamp(30px, 6vw, 40px);">
                                📊 ΜΕΤΑΒΑΣΗ ΣΤΟ ΕΡΩΤΗΜΑΤΟΛΟΓΙΟ
                            </a>
                        </div>
                    </div>

                    <div id="leaderboardLocked" style="display: none; padding-bottom: 80px;">
                        <div class="intro-box" style="text-align: center; padding: 60px 30px;">
                            <div style="font-size: clamp(80px, 20vw, 120px); margin-bottom: 30px; animation: swing 3s ease-in-out infinite;">
                                🔒
                            </div>
                            <h2 style="color: #1a1a2e; font-size: clamp(20px, 5vw, 28px); margin-bottom: 20px;">
                                ΤΑ ΑΠΟΤΕΛΕΣΜΑΤΑ ΔΕΝ ΕΙΝΑΙ ΑΚΟΜΑ ΔΙΑΘΕΣΙΜΑ
                            </h2>
                            <div style="background: #d4edda; border: 2px solid #28a745; border-radius: 12px; padding: 20px; margin: 30px auto; max-width: 500px;">
                                <div style="font-size: 24px; margin-bottom: 10px;"></div>
                                <div style="color: #155724; font-weight: bold;">
                                    Η ΣΕΛΙΔΑ ΘΑ ΑΝΑΝΕΩΘΕΙ ΟΤΑΝ ΟΛΕΣ ΟΙ ΟΜΑΔΕΣ ΟΛΟΚΛΗΡΩΣΟΥΝ ΤΗΝ ΕΡΕΥΝΑ ΤΟΥΣ!!<br>
                                </div>
                            </div>
                            <p style="margin-top: 30px; color: #999; font-size: 14px;">
                                Έλεγχος ενημερώσεων<span class="loading-dots"><span>.</span><span>.</span><span>.</span></span>
                            </p>
                        </div>
                    </div>

                    <div id="leaderboardUnlocked" style="display: none; padding-bottom: 80px;">
                        <div class="stats-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px; margin-bottom: 25px;">
                            <div class="stat-card">
                                <h3>Σύνολο Υποβολών</h3>
                                <div class="value" id="totalTeams">-</div>
                            </div>
                            <div class="stat-card">
                                <h3>Τέλειες Λύσεις</h3>
                                <div class="value" id="perfectScores">-</div>
                            </div>
                            <div class="stat-card">
                                <h3>Μέσος Όρος Βαθμών</h3>
                                <div class="value" id="avgScore">-</div>
                            </div>
                            <div class="stat-card">
                                <h3>Μέσος Χρόνος</h3>
                                <div class="value" id="avgTime">-</div>
                            </div>
                        </div>

                        <div style="background: white; border-radius: 15px; padding: 20px; box-shadow: 0 10px 40px rgba(0,0,0,0.3); overflow-x: auto;">
                            <h2 style="color: #1a1a2e; font-size: clamp(18px, 4vw, 24px); margin-bottom: 20px; padding-bottom: 15px; border-bottom: 3px solid #ff6b00;">
                                🏆 ΚΑΤΑΤΑΞΗ ΟΜΑΔΩΝ
                            </h2>
                            <table id="resultsTable" style="width: 100%; border-collapse: collapse; min-width: 650px; display: none;">
                                <thead>
                                    <tr style="background: linear-gradient(135deg, #0f3460 0%, #16213e 100%); color: white;">
                                        <th style="padding: 12px 10px; text-align: left; font-size: clamp(11px, 2vw, 13px); text-transform: uppercase;">Θέση</th>
                                        <th style="padding: 12px 10px; text-align: left; font-size: clamp(11px, 2vw, 13px); text-transform: uppercase;">Ομάδα</th>
                                        <th style="padding: 12px 10px; text-align: left; font-size: clamp(11px, 2vw, 13px); text-transform: uppercase;">Βαθμολογία</th>
                                        <th style="padding: 12px 10px; text-align: left; font-size: clamp(11px, 2vw, 13px); text-transform: uppercase;">Τίτλος</th>
                                        <th style="padding: 12px 10px; text-align: left; font-size: clamp(11px, 2vw, 13px); text-transform: uppercase;">Χρόνος</th>
                                    </tr>
                                </thead>
                                <tbody id="resultsTableBody">
                                    <tr>
                                        <td colspan="5" style="text-align: center; padding: 40px; color: #666;">Φόρτωση...</td>
                                    </tr>
                                </tbody>
                            </table>
                            <div id="resultsCards" style="display: none;"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="footer">
            <p><strong>ΦΕΣΤΙΒΑΛ ΑΣΤΥΝΟΜΙΚΗΣ ΛΟΓΟΤΕΧΝΙΑΣ 2025</strong></p>
            <p style="margin-top: 10px; opacity: 0.7; font-size: 12px;">
                11 ΤΕΚΜΗΡΙΑ | 5 ΥΠΟΠΤΟΙ | 1 ΑΛΗΘΕΙΑ
            </p>
        </div>
    </div>

<div id="alertNotification" style="display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: linear-gradient(135deg, #9c27b0 0%, #7b1fa2 100%); color: white; padding: 30px 40px; border-radius: 15px; box-shadow: 0 20px 60px rgba(0,0,0,0.5); z-index: 10000; max-width: 500px; width: 90%; animation: slideIn 0.3s ease;">
    <div style="font-size: 48px; text-align: center; margin-bottom: 15px;">📢</div>
    <h3 style="color: white; text-align: center; margin-bottom: 15px; font-size: 20px;">ΕΙΔΟΠΟΙΗΣΗ ΑΠΟ ΔΙΟΡΓΑΝΩΤΕΣ</h3>
    <div id="alertMessageContent" style="background: rgba(255,255,255,0.2); padding: 20px; border-radius: 10px; margin-bottom: 20px; font-size: 16px; line-height: 1.6; text-align: center;"></div>
    <button onclick="closeAlert()" style="width: 100%; padding: 15px; background: white; color: #9c27b0; border: none; border-radius: 10px; font-weight: bold; font-size: 16px; cursor: pointer; transition: all 0.3s;">
        ✓ ΚΑΤΑΝΟΗΣΑ
    </button>
</div>

<div id="alertOverlay" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); z-index: 9999; backdrop-filter: blur(3px);"></div>

<script src="js/suspects.js"></script>
<script src="js/pages/index.js"></script>
</body>
</html>